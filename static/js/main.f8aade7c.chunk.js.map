{"version":3,"sources":["components/Game/useGameReducer.js","sfx/mp3/clear1.mp3","sfx/mp3/clear2.mp3","sfx/mp3/clear3.mp3","sfx/mp3/clear4.mp3","sfx/mp3/gameOver.mp3","sfx/mp3/locked.mp3","sfx/mp3/spawn.mp3","components/Game/Game.js","engine/checks.js","engine/actions.js","engine/clearLines.js","components/Game/reducer.js","engine/tetrominoes.js","engine/randomizer.js","components/Game/index.js","sfx/audio.js","App.js","reportWebVitals.js","index.js"],"names":["audio","randomizer","Game","customHook","state","className","data-testid","playfield","map","row","y","phase","every","x","block","tetromino","shape","top","left","queue","slice","i","lines","merge","occupied","landed","height","length","some","returnOriginalIfInvalid","updatedTetromino","originalTetromino","width","isPositionValid","rotateLeft","_","rotateRight","directions","directionOffset","move","direction","emptyLines","Array","phases","doLock","lockResult","locked","lock","undefined","sfx","visitors","tick","action","payload","clear","clearResult","clearedPlayfield","reduceRight","acc","concat","linesCleared","clearLines","interval","Math","max","floor","spawn","newTetromino","newQueue","isAlive","alive","validPhases","reducer","type","includes","keyMappings","ArrowLeft","ArrowRight","ArrowDown","o","s","z","t","j","l","tetrominoes","name","AudioContext","context","play","file","promiseOfAudio","fetch","then","data","arrayBuffer","decodeAudioData","decode","audioBuffer","source","createBufferSource","buffer","connect","destination","start","clear1","clear1Mp3","clear2","clear2Mp3","clear3","clear3Mp3","clear4","clear4Mp3","lockedMp3","spawnMp3","gameOver","gameOverMp3","Audio","GameFactory","xs","result","randomIndex","random","temp","shuffle","useReducer","score","dispatch","useEffect","handle","setInterval","clearInterval","phaseVisitors","setTimeout","onKeydown","e","key","document","body","addEventListener","removeEventListener","App","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.f8aade7c.chunk.js","sourcesContent":["/* eslint-disable react-hooks/rules-of-hooks */\r\n\r\nimport { phases, reducer } from './reducer';\r\nimport { useEffect, useReducer } from 'react';\r\n\r\nimport { directions } from '../../engine/actions';\r\n\r\nconst keyMappings = {\r\n  ArrowLeft: directions.left,\r\n  ArrowRight: directions.right,\r\n  ArrowDown: directions.down\r\n};\r\nexport const UseGameReducer = (audio, randomizer) => () => {\r\n  const queue = randomizer();\r\n  const tetromino = queue[0];\r\n  const [state, dispatch] = useReducer(reducer, {\r\n    playfield: [...Array(20)].map(() => [...Array(10)].map(() => undefined)),\r\n    queue: queue.slice(1),\r\n    phase: phases.descending,\r\n    tetromino,\r\n    alive: true,\r\n    score: 0,\r\n    lines: 0,\r\n    interval: 1000\r\n  });\r\n  useEffect(() => {\r\n    const handle = state.alive\r\n      ? setInterval(() => dispatch({ type: 'tick' }), state.interval)\r\n      : 0;\r\n    return () => clearInterval(handle);\r\n  }, [state.alive, state.interval]);\r\n  useEffect(() => {\r\n    if (state.sfx) {\r\n      audio[state.sfx]();\r\n    }\r\n  }, [state.sfx]);\r\n  useEffect(() => {\r\n    const phaseVisitors = {\r\n      [phases.spawning]: () =>\r\n        setTimeout(\r\n          () =>\r\n            dispatch({\r\n              type: 'spawn',\r\n              payload: state.queue.length <= 3 ? randomizer() : []\r\n            }),\r\n          500\r\n        ),\r\n      [phases.locking]: () =>\r\n        setTimeout(() => dispatch({\r\n          type: 'lock'\r\n        }), 500),\r\n      [phases.clearing]: () =>\r\n        setTimeout(\r\n          () =>\r\n            dispatch({\r\n              type: 'clear'\r\n            }),\r\n          500\r\n        )\r\n    };\r\n    phaseVisitors[state.phase]?.();\r\n  }, [state.phase, state.queue.length]);\r\n  useEffect(() => {\r\n    const onKeydown = (e) => {\r\n      if (keyMappings[e.key]) {\r\n        dispatch({ type: 'move', payload: keyMappings[e.key] });\r\n      }\r\n      if (e.key === 'ArrowUp') {\r\n        dispatch({ type: 'rotateRight' });\r\n      }\r\n    };\r\n    if (state.alive) {\r\n      document.body.addEventListener('keydown', onKeydown);\r\n    }\r\n    return () => document.body.removeEventListener('keydown', onKeydown);\r\n  }, [state.alive]);\r\n  return {\r\n    state\r\n  };\r\n};\r\n","export default __webpack_public_path__ + \"static/media/clear1.fe1236db.mp3\";","export default __webpack_public_path__ + \"static/media/clear2.42d27630.mp3\";","export default __webpack_public_path__ + \"static/media/clear3.50cd846e.mp3\";","export default __webpack_public_path__ + \"static/media/clear4.529df8a4.mp3\";","export default __webpack_public_path__ + \"static/media/gameOver.f52cf5f0.mp3\";","export default __webpack_public_path__ + \"static/media/locked.f92eb651.mp3\";","export default __webpack_public_path__ + \"static/media/spawn.dcb5ecc2.mp3\";","import React from 'react';\r\n\r\nconst Game = (customHook) => () => {\r\n  const { state } = customHook();\r\n  return (\r\n    <>\r\n      <div className=\"frame\">\r\n        <div data-testid=\"playfield\" className=\"playfield\">\r\n          {state.playfield.map((row, y) => (\r\n            <div\r\n              key={y}\r\n              className={\r\n                'row' +\r\n                (state.phase === 'clearing' && row.every((x) => x)\r\n                  ? ' clearing'\r\n                  : '')\r\n              }\r\n            >\r\n              {row.map((block, x) => (\r\n                <div\r\n                  key={x}\r\n                  className={\r\n                    state.tetromino?.shape?.[y - state.tetromino.top]?.[\r\n                      x - state.tetromino.left\r\n                    ] ||\r\n                    block ||\r\n                    ''\r\n                  }\r\n                />\r\n              ))}\r\n            </div>\r\n          ))}\r\n        </div>\r\n      </div>\r\n      <div className=\"frame\">\r\n        <h1>NEXT</h1>\r\n        <div className=\"next-tetrominoes\">\r\n          {state.queue.slice(0, 3).map((tetromino, i) => (\r\n            <div className=\"next-tetromino\" key={i}>\r\n              {tetromino.shape.map((row, y) => (\r\n                <div key={y} className=\"row\">\r\n                  {row.map((block, x) => (\r\n                    <div className={block} key={x}></div>\r\n                  ))}\r\n                </div>\r\n              ))}\r\n            </div>\r\n          ))}\r\n        </div>\r\n        <h1>LINES</h1>\r\n        <div className=\"lines\">{state.lines}</div>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Game;\r\n","const merge = (tetromino, playfield) =>\n  playfield.map((row, y) =>\n    row.map(\n      (occupied, x) =>\n        occupied || tetromino.shape[y - tetromino.top]?.[x - tetromino.left]\n    )\n  );\n\nexport const landed = (tetromino, playfield) => {\n  const height = playfield.length;\n  return tetromino.shape.some((row, y) =>\n    row.some(\n      (occupied, x) =>\n        occupied &&\n        (y + tetromino.top >= height - 1 ||\n          playfield[y + tetromino.top + 1][x + tetromino.left])\n    )\n  );\n};\n\nexport const lock = (tetromino, playfield) => {\n  const locked = landed(tetromino, playfield);\n  return {\n    playfield: locked ? merge(tetromino, playfield) : playfield,\n    locked\n  };\n};\n\nexport const alive = (tetromino, playfield) =>\n  !tetromino.shape.some((row, y) =>\n    row.some(\n      (occupied, x) =>\n        occupied && playfield[y + tetromino.top][x + tetromino.left]\n    )\n  );\n","const isPositionValid = (tetromino, playfield) => {\n  const width = playfield[0].length;\n  const height = playfield.length;\n  return !tetromino.shape.some((row, y) =>\n    row.some(\n      (occupied, x) =>\n        occupied &&\n        (x + tetromino.left < 0 ||\n          x + tetromino.left >= width ||\n          y + tetromino.top >= height ||\n          playfield[y + tetromino.top][x + tetromino.left])\n    )\n  );\n};\n\nconst returnOriginalIfInvalid = (\n  updatedTetromino,\n  originalTetromino,\n  playfield\n) =>\n  isPositionValid(updatedTetromino, playfield)\n    ? updatedTetromino\n    : originalTetromino;\n\nexport const rotateLeft = (tetromino, playfield) =>\n  returnOriginalIfInvalid(\n    {\n      ...tetromino,\n      shape: tetromino.shape.map((row, y) =>\n        row.map((_, x) => tetromino.shape[x][tetromino.shape.length - 1 - y])\n      )\n    },\n    tetromino,\n    playfield\n  );\nexport const rotateRight = (tetromino, playfield) =>\n  returnOriginalIfInvalid(\n    {\n      ...tetromino,\n      shape: tetromino.shape.map((row, y) =>\n        row.map((_, x) => tetromino.shape[tetromino.shape.length - 1 - x][y])\n      )\n    },\n    tetromino,\n    playfield\n  );\n\nexport const directions = {\n  left: 37,\n  right: 39,\n  down: 40\n};\n\nconst directionOffset = {\n  [directions.left]: {\n    left: -1,\n    top: 0\n  },\n  [directions.right]: {\n    left: 1,\n    top: 0\n  },\n  [directions.down]: {\n    left: 0,\n    top: 1\n  }\n};\n\nexport const move = (tetromino, playfield, direction) =>\n  returnOriginalIfInvalid(\n    {\n      ...tetromino,\n      left: tetromino.left + directionOffset[direction].left,\n      top: tetromino.top + directionOffset[direction].top\n    },\n    tetromino,\n    playfield\n  );\n","const emptyLines = (width, height) =>\n  [...Array(height)].map(() => [...Array(width)].map(() => undefined));\n\nexport const clearLines = (playfield) => {\n  const width = playfield[0].length;\n  const clearedPlayfield = playfield.reduceRight(\n    (acc, row) => (row.every((occupied) => occupied) ? acc : [row].concat(acc)),\n    []\n  );\n  const linesCleared = playfield.length - clearedPlayfield.length;\n  return {\n    playfield: emptyLines(width, linesCleared).concat(clearedPlayfield),\n    linesCleared\n  };\n};\n","import { alive, landed, lock } from '../../engine/checks';\r\nimport {\r\n  directions,\r\n  move,\r\n  rotateLeft,\r\n  rotateRight\r\n} from '../../engine/actions';\r\n\r\nimport { clearLines } from '../../engine/clearLines';\r\n\r\nexport const phases = {\r\n  spawning: 'spawning',\r\n  descending: 'descending',\r\n  locking: 'locking',\r\n  clearing: 'clearing',\r\n  gameOver: 'gameOver'\r\n};\r\n\r\nconst doLock = (state) => {\r\n  const { tetromino, playfield } = state;\r\n  const lockResult = lock(tetromino, playfield);\r\n  return lockResult.locked\r\n    ? {\r\n        ...state,\r\n        tetromino: undefined,\r\n        playfield: lockResult.playfield,\r\n        sfx: 'locked',\r\n        phase: phases.clearing\r\n      }\r\n    : {\r\n        ...state,\r\n        phase: phases.descending\r\n      };\r\n};\r\n\r\nconst visitors = {\r\n  tick: (state) => {\r\n    const { tetromino, playfield } = state;\r\n    const updatedTetromino = move(tetromino, playfield, directions.down);\r\n    return {\r\n      ...state,\r\n      tetromino: updatedTetromino,\r\n      phase: landed(updatedTetromino, playfield)\r\n        ? phases.locking\r\n        : phases.descending\r\n    };\r\n  },\r\n  move: (state, action) => {\r\n    const { tetromino, playfield } = state;\r\n    const updatedTetromino = move(tetromino, playfield, action.payload);\r\n    return state.phase === phases.locking && action.payload === directions.down\r\n      ? doLock(state)\r\n      : {\r\n          ...state,\r\n          tetromino: updatedTetromino,\r\n          phase: landed(updatedTetromino, playfield)\r\n            ? phases.locking\r\n            : phases.descending\r\n        };\r\n  },\r\n  lock: doLock,\r\n  clear: (state) => {\r\n    const { playfield } = state;\r\n    const clearResult = clearLines(playfield);\r\n    const lines = state.lines + clearResult.linesCleared;\r\n    return {\r\n      ...state,\r\n      playfield: clearResult.playfield,\r\n      lines,\r\n      sfx:\r\n        clearResult.linesCleared > 0\r\n          ? 'clear' + clearResult.linesCleared\r\n          : undefined,\r\n      interval: Math.max(100, 1000 - Math.floor(lines / 10) * 100),\r\n      phase: phases.spawning\r\n    };\r\n  },\r\n  rotateRight: (state) => {\r\n    const { tetromino, playfield } = state;\r\n    return {\r\n      ...state,\r\n      tetromino: rotateRight(tetromino, playfield)\r\n    };\r\n  },\r\n  rotateLeft: (state) => {\r\n    const { tetromino, playfield } = state;\r\n    return {\r\n      ...state,\r\n      tetromino: rotateLeft(tetromino, playfield)\r\n    };\r\n  },\r\n  spawn: (state, action) => {\r\n    const { queue, playfield } = state;\r\n    const newTetromino = queue[0];\r\n    const newQueue = queue.slice(1).concat(action.payload || []);\r\n    const isAlive = alive(newTetromino, playfield);\r\n    return {\r\n      ...state,\r\n      tetromino: newTetromino,\r\n      phase: isAlive ? phases.descending : phases.gameOver,\r\n      sfx: isAlive ? 'spawn' : 'gameOver',\r\n      queue: newQueue,\r\n      alive: isAlive\r\n    };\r\n  }\r\n};\r\nconst validPhases = {\r\n  tick: [phases.descending, phases.locking],\r\n  move: [phases.descending, phases.locking],\r\n  lock: [phases.locking],\r\n  clear: [phases.clearing],\r\n  rotateLeft: [phases.descending, phases.locking],\r\n  rotateRight: [phases.descending, phases.locking],\r\n  spawn: [phases.spawning]\r\n};\r\nexport const reducer = (state, action) =>\r\n  validPhases[action.type]?.includes(state.phase)\r\n    ? visitors[action.type](state, action)\r\n    : state;\r\n","//https://tetris.fandom.com/wiki/SRS\r\nconst _ = undefined;\r\nconst o = 'O';\r\nexport const O = {\r\n  top: 0,\r\n  left: 4,\r\n  name: o,\r\n  shape: [\r\n    [o, o],\r\n    [o, o]\r\n  ]\r\n};\r\nconst i = 'I';\r\nexport const I = {\r\n  top: 0,\r\n  left: 3,\r\n  name: i,\r\n  shape: [\r\n    [_, _, _, _],\r\n    [i, i, i, i],\r\n    [_, _, _, _],\r\n    [_, _, _, _]\r\n  ]\r\n};\r\nconst s = 'S';\r\nexport const S = {\r\n  top: 0,\r\n  left: 3,\r\n  name: s,\r\n  shape: [\r\n    [_, s, s],\r\n    [s, s, _],\r\n    [_, _, _]\r\n  ]\r\n};\r\nconst z = 'Z';\r\nexport const Z = {\r\n  top: 0,\r\n  left: 3,\r\n  name: z,\r\n  shape: [\r\n    [z, z, _],\r\n    [_, z, z],\r\n    [_, _, _]\r\n  ]\r\n};\r\nconst t = 'T';\r\nexport const T = {\r\n  top: 0,\r\n  left: 3,\r\n  name: t,\r\n  shape: [\r\n    [_, t, _],\r\n    [t, t, t],\r\n    [_, _, _]\r\n  ]\r\n};\r\n\r\nconst j = 'J';\r\nexport const J = {\r\n  top: 0,\r\n  left: 3,\r\n  name: j,\r\n  shape: [\r\n    [j, _, _],\r\n    [j, j, j],\r\n    [_, _, _]\r\n  ]\r\n};\r\n\r\nconst l = 'L';\r\nexport const L = {\r\n  top: 0,\r\n  left: 3,\r\n  name: l,\r\n  shape: [\r\n    [_, _, l],\r\n    [l, l, l],\r\n    [_, _, _]\r\n  ]\r\n};\r\n","import { I, J, L, O, S, T, Z } from './tetrominoes';\r\n\r\nconst shuffle = (xs) => {\r\n  const result = xs.slice(0);\r\n  let i = result.slice(0).length - 1;\r\n  while (i >= 0) {\r\n    const randomIndex = Math.floor(Math.random() * (i + 1));\r\n    const temp = result[i];\r\n    result[i] = result[randomIndex];\r\n    result[randomIndex] = temp;\r\n    i = i - 1;\r\n  }\r\n  return result;\r\n};\r\nconst tetrominoes = [I, O, T, S, Z, J, L];\r\n\r\nexport const randomizer = () => shuffle(tetrominoes);\r\n","import { Audio } from '../../sfx/audio';\r\nimport GameFactory from './Game';\r\nimport { UseGameReducer } from './useGameReducer';\r\nimport { randomizer } from '../../engine/randomizer';\r\n\r\nconst audio = Audio(AudioContext);\r\nconst useGameReducer = UseGameReducer(audio, randomizer);\r\nconst Game = GameFactory(useGameReducer);\r\nexport default Game;\r\n","import clear1Mp3 from './mp3/clear1.mp3';\r\nimport clear2Mp3 from './mp3/clear2.mp3';\r\nimport clear3Mp3 from './mp3/clear3.mp3';\r\nimport clear4Mp3 from './mp3/clear4.mp3';\r\nimport gameOverMp3 from './mp3/gameOver.mp3';\r\nimport lockedMp3 from './mp3/locked.mp3';\r\nimport spawnMp3 from './mp3/spawn.mp3';\r\n\r\nexport const Audio = (AudioContext) => {\r\n  const context = new AudioContext();\r\n  const decode = (file) =>\r\n    fetch(file)\r\n      .then((data) => data.arrayBuffer())\r\n      .then((arrayBuffer) => context.decodeAudioData(arrayBuffer));\r\n\r\n  const play = (file) => {\r\n    const promiseOfAudio = decode(file);\r\n    return () =>\r\n      promiseOfAudio.then((audioBuffer) => {\r\n        const source = context.createBufferSource();\r\n        source.buffer = audioBuffer;\r\n        source.connect(context.destination);\r\n        source.start();\r\n      });\r\n  };\r\n\r\n  return {\r\n    clear1: play(clear1Mp3),\r\n    clear2: play(clear2Mp3),\r\n    clear3: play(clear3Mp3),\r\n    clear4: play(clear4Mp3),\r\n    locked: play(lockedMp3),\r\n    spawn: play(spawnMp3),\r\n    gameOver: play(gameOverMp3)\r\n  };\r\n};\r\n","import './App.css';\n\nimport Game from './components/Game/index';\nimport React from 'react';\n\nconst App = () => <Game />;\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}